webpackJsonp([1],{120:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(118),s=i(322),n=i.n(s);a.a.config.productionTip=!1,new a.a({el:"#app",template:"<App/>",components:{App:n.a}})},121:function(e,t,i){"use strict";function a(e,t,i,a,s){return a+(s-a)*(e-t)/(i-t)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(317),n=i(323),r=i.n(n),o=(i(114),i(314)),l=i(316),c=i(124),d=c.db.ref("data");t.default={name:"app",components:{Mapbox:s.a,Sheet:r.a},data:function(){return{fake:!1,dataReady:!1,mapReady:!1,data:[],map:null,sparklingTrailLayer:null,sparklingTrail:!1,currentSelected:[],sparklingSwitchVisible:!1,randomNum:2,moveCircleActive:!0,circle:{x:0,y:0,o:0,r:50,off:!0}}},watch:{dataReady:function(e){console.log("dataReady?",e),e&&this.mapReady&&this.loadData()},mapReady:function(e){console.log("mapReady?",e),this.dataReady&&e&&this.loadData()}},mounted:function(){var e=this;console.log("Fetching Firebase data..."),d.once("value").then(function(t){console.log(String(t.val().length),"wineries successfully downloaded from firebase");for(var i=[],a=t.val().length-1;a>=0;a--)e.data.push(t.val()[a]),i.push(t.val()[a]);return i}).then(function(t){e.dataReady=!0})},methods:{resizedSheet:function(){window.dispatchEvent(new Event("resize"))},toggleSparklingSwitch:function(e){for(var t=this,i=[],a=this.data.length-1;a>=0;a--)t.data[a].properties.trails.includes("sparkling")&&i.push(t.data[a].properties.id);i.unshift("in","id"),this.sparklingSwitchVisible=!0,//!this.sparklingSwitchVisible
this.circle.o=0,this.sparklingTrail?(this.map.setFilter("wineries",i),this.map.setFilter("triangles",i)):(this.map.setFilter("wineries",null),this.map.setFilter("triangles",null))},getRandomNum:function(){var e=Math.floor(134*Math.random()+7);return this.randomNum=e,e},mapResized:function(){},mapClicked:function(e,t){console.log(t)}},easeBearing:function(e){return e.getBearing()>0?-5:5},flytoZoom:function(e){return this.map.getZoom()+.5},mapMouseMoved:function(e,t){if(e.isSourceLoaded("winery-label")){var i=e.queryRenderedFeatures(t.point,{layers:["wineries","triangles"]});e.getCanvas().style.cursor=i.length?"pointer":""}},mapMoveStart:function(e,t){this.circle.o=0,this.sparklingSwitchVisible=!1},mapMoveEnd:function(e){this.circle.o=1;this.moveCircleActive=!1,this.currentSelected=this.nearest,this.randomNum=this.getRandomNum(),this.moveCircle(e),this.zoomCircle(e)},mapMoving:function(e){this.moveCircle(e,map),this.moveCircleActive},mapLoaded:function(e){this.map=e,this.mapReady=!0},dataLoading:function(e){},loadData:function(){console.log("loading data..."),this.map.addSource("winery-label",{type:"geojson",data:{type:"FeatureCollection",features:this.data}}),this.map.addLayer({id:"wineries",type:"symbol",source:"winery-label",filter:["==","$type","Point"],layout:{"text-line-height":1,"text-size":{base:1.3,stops:[[4,6],[14,23]]},"text-allow-overlap":!0,"text-font":["Roboto Medium","Arial Unicode MS Regular"],"text-justify":"left",visibility:"visible","text-offset":[1,.1],"text-anchor":"left","text-field":"{label}","text-max-width":15},paint:{"text-color":"#65132C"}}),this.map.addLayer({id:"triangles",type:"symbol",source:"winery-label",filter:["==","$type","Point"],layout:{"text-size":{base:1,stops:[[8,14],[14,15]]},"text-font":["Knockout 29 Junior Liteweight"],visibility:"visible","icon-size":{base:.8,stops:[[8,.1],[15,1.1]]},"text-offset":[0,-.2],"icon-image":"triangle","icon-allow-overlap":!0},paint:{"text-color":"hsl(0, 0%, 100%)","icon-opacity":.7}}),console.log("data loaded"),this.zoomCircle(this.map),this.moveCircle(this.map);this.$refs.map.$el},zoomCircle:function(e){this.map.getZoom()<9?this.circle.r=0:this.circle.r=a(this.map.getZoom(),15,9,50,15)},mapZooming:function(e){this.zoomCircle(e)},moveCircle:function(e){if(e.isSourceLoaded("winery-label")){console.log("source is loaded");var t=e.queryRenderedFeatures({layers:["triangles"]});if(t.length>0){this.circle.off=!1;for(var i=l.uniqBy(t,"properties.id"),a=null,s=e.getCenter().lat,n=e.getCenter().lng,r=999999999999,c=i.length-1;c>=0;c--){var d=o([s,n],[i[c].geometry.coordinates[1],i[c].geometry.coordinates[0]],{format:!1,unit:"meters"});a||(a=i[c]),d<r&&(a=i[c],r=d)}var p=e.project([a.geometry.coordinates[0],a.geometry.coordinates[1]]),h=parseInt(p.x-1.02*this.circle.r),m=parseInt(p.y-1.02*this.circle.r);this.circle.x=h,this.circle.y=m,this.moveCircleActive&&(console.log("moving circle"),this.circle.o=1),a!==this.currentSelected&&(this.nearest=a)}else this.circle.o=0,this.currentSelected=null,this.circle.off=!0}}}},122:function(e,t,i){"use strict";function a(e,t,i){return Math.min(i,Math.max(t,e))}function s(e,t,i,a,s){return a+(s-a)*(e-t)/(i-t)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(118),r=i(328),o=i(114);n.a.use(r.a),t.default={name:"sheet",props:["startingWidth"],created:function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;this.maxSheetWidth-=this.minSheetWidth,this.dim.w=parseInt(.666*e)},methods:{pan:function(e,t){var i=this;if("panstart"==e&&(this.original_width=this.dim.w,this.resizing=!0),"panend"==e){this.resizing=!1;var n=parseInt(this.dim.w+t.distance*(.7*t.velocityX));this.maxSheetResize=Math.max(this.dim.w,this.original_width),o.animate(this.dim,{w:a(n,this.minSheetWidth,this.$refs.fullwidth.offsetWidth-100)},{type:o.spring,duration:s(Math.abs(t.velocityX),0,6,1e3,100),frequency:274,friction:516,complete:function(){t.deltaX>0?(i.$emit("resized"),this.panDirection="panright"):(i.$emit("resized"),this.panDirection="panleft")}})}this.dim.w=this.original_width+t.deltaX,this.panDirection=e}},data:function(){return{dim:{w:600},original_width:200,minSheetWidth:100,resizing:!1,maxSheetResize:0,panDirection:null,maxSheetWidth:1920}}}},123:function(e,t){e.exports={apiKey:"AIzaSyArNJMh8OxNdVEN52aU516OPzQezyay-_w",authDomain:"ahwr-e58a9.firebaseapp.com",databaseURL:"https://ahwr-e58a9.firebaseio.com",projectId:"ahwr-e58a9",storageBucket:"ahwr-e58a9.appspot.com",messagingSenderId:"702518506285"}},124:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"db",function(){return r});var a=i(115);i(312);var s=i(123),n=a.initializeApp(s),r=n.database()},306:function(e,t){},307:function(e,t){},322:function(e,t,i){i(306);var a=i(117)(i(121),i(324),null,null);e.exports=a.exports},323:function(e,t,i){i(307);var a=i(117)(i(122),i(325),"data-v-d9439390",null);e.exports=a.exports},324:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container",attrs:{id:"app"}},[e.data?i("transition-group",{attrs:{name:"slide"}},e._l(e.data,function(t,a,s){return t.properties.id==e.currentSelected.properties.id?i("div",{key:a,staticClass:"information winery",attrs:{id:"info-container"}},[i("div",{staticClass:"winery-container"},[i("div",{staticClass:"winery-name"},[e._v(e._s(t.properties.name)),i("span",{staticClass:"winery-region"},[e._v(e._s(t.properties.region))])]),e._v(" "),i("div",{staticClass:"winery-desc"},[e._v(e._s(t.properties.desc))]),e._v(" "),i("div",{staticClass:"winery-where"},[i("span",{staticClass:"label"},[e._v("Where")]),e._v(e._s(t.properties.where)),i("div",{staticClass:"winery-tel"},[i("span",{staticClass:"label"},[e._v("T")]),e._v(e._s(t.properties.tel))])]),e._v(" "),i("div",{staticClass:"winery-open"},[i("span",{staticClass:"label"},[e._v("Open")]),e._v(e._s(t.properties.open))]),e._v(" "),i("a",{staticClass:"winery-website",attrs:{target:"_blank",href:"http://"+t.properties.website}},[e._v(e._s(t.properties.website))])])]):e._e()})):e._e(),e._v(" "),i("v-container",{class:["controls","container",{active:e.sparklingSwitchVisible}]},[i("v-row",[i("v-col",{attrs:{xs12:"",md12:""}},[i("v-card",{staticClass:"white elevation-7",staticStyle:{"border-radius":"30px"}},[i("v-card-text",{staticStyle:{"padding-top":"0px !important"}},[i("v-switch",{class:["switch",{active:e.sparklingTrail}],attrs:{label:"Sparkling Trail",primary:"",light:""},nativeOn:{click:function(t){e.toggleSparklingSwitch()}},model:{value:e.sparklingTrail,callback:function(t){e.sparklingTrail=t},expression:"sparklingTrail"}})],1)],1)],1)],1)],1),e._v(" "),i("sheet",{ref:"sheet",staticClass:"sheet",attrs:{startingWidth:"800"},on:{resized:e.resizedSheet}},[i("mapbox",{ref:"map",attrs:{"access-token":"pk.eyJ1IjoiZWRhbndlaXMiLCJhIjoiY2lmMTVtdWQ0MDRsOHNkbTV2OXd3cDNwNiJ9.MxWj73wGNEvrPSjsh6TJjw","map-options":{style:"mapbox://styles/edanweis/cj2iddj93001k2rph61u9lw6f",maxBounds:[[138.1381,-35.54],[139.705,-34.4558]],center:[138.7333,-34.9141],zoom:13,hash:!0},navControl:{show:!1},"geolocate-control":{show:!1,position:"top-left"}},on:{"map-resize":e.mapResized,"map-movestart":e.mapMoveStart,"map-move":e.mapMoving,"map-click":e.mapClicked,"map-mousemove":e.mapMouseMoved,"map-load":e.mapLoaded,"map-zoom":e.mapZooming,"map-moveend":e.mapMoveEnd,"map-dataloading":e.dataLoading}}),e._v(" "),i("div",{class:["circle",{off:1==e.circle.off},{active:1==e.circle.o},{inactive:0==e.circle.o}],style:{transform:"translateX("+e.circle.x+"px) translateY("+e.circle.y+"px)",width:2*e.circle.r+"px",height:2*e.circle.r+"px"}}),e._v(" "),i("div",{class:["multiply","circle",{off:1==e.circle.off},{active:1==e.circle.o},{inactive:0==e.circle.o}],style:{transform:"translateX("+e.circle.x+"px) translateY("+e.circle.y+"px)",width:2*e.circle.r+"px",height:2*e.circle.r+"px"}})],1)],1)},staticRenderFns:[]}},325:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:["elevation-5",{"elevation-20":!!e.resizing}],style:{width:e.dim.w+"px",minWidth:e.dim.w+"px"},attrs:{id:"sheet-container"}},[i("div",{directives:[{name:"touch",rawName:"v-touch:pan",value:e.pan,expression:"pan",arg:"pan"}],staticClass:"resize-handler"}),e._v(" "),i("div",{ref:"fullwidth",attrs:{id:"fullwidth"}}),e._v(" "),i("div",{staticClass:"arrow noselect"}),e._v(" "),i("div",{class:["icon","noselect",{panleft:"panleft"==e.panDirection}]},[e._v("keyboard_arrow_right")]),e._v(" "),e._t("default")],2)},staticRenderFns:[]}},330:function(e,t,i){i(119),e.exports=i(120)}},[330]);
//# sourceMappingURL=app.87629cf4cf8a066fe7f0.js.map